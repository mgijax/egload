#!/bin/sh
#
#  formatreports.sh
###########################################################################
#
#  Purpose:  This script formats the reports generated by the egload.
#
#  Usage:
#
#      formatreports.sh
#
#  Outputs:
#
#  Exit Codes:
#
#      0:  Successful completion
#      1:  Fatal error occurred
#      2:  Non-fatal error occurred
#
#  Assumes:  Nothing
#
#  Notes:  None
#
###########################################################################

#
#  Set up a log file for the shell script in case there is an error
#  during configuration and initialization.
#
cd `dirname $0`/..
LOG=`pwd`/egloadreports.log
rm -f ${LOG}

#
#  Verify the argument(s) to the shell script.
#
if [ $# -ne 0 ]
then
    echo "Usage: $0" | tee -a ${LOG}
    exit 1
fi

#
#  Verify and source the configuration file name.
#
CONFIG=`pwd`/egload.config
if [ ! -r ${CONFIG} ]
then
    echo "Cannot read configuration file: ${CONFIG}" | tee -a ${LOG}
    exit 1
fi
. ${CONFIG}

cd ${RPTDIR}

sort ${ONE_ONE_SORT} ${ONE_ONE_OUTFILE_NAME} > ${ONE_ONE_OUTFILE_NAME}.tmp
mv ${ONE_ONE_OUTFILE_NAME}.tmp ${ONE_ONE_OUTFILE_NAME}

sort ${ONE_N_SORT} ${ONE_N_OUTFILE_NAME} > ${ONE_N_OUTFILE_NAME}.tmp
mv ${ONE_N_OUTFILE_NAME}.tmp ${ONE_N_OUTFILE_NAME}

sort ${ONE_ZERO_SORT} ${ONE_ZERO_OUTFILE_NAME} > ${ONE_ZERO_OUTFILE_NAME}.tmp
mv ${ONE_ZERO_OUTFILE_NAME}.tmp ${ONE_ZERO_OUTFILE_NAME}

sort ${ZERO_ONE_SORT} ${ZERO_ONE_OUTFILE_NAME} > ${ZERO_ONE_OUTFILE_NAME}.tmp
mv ${ZERO_ONE_OUTFILE_NAME}.tmp ${ZERO_ONE_OUTFILE_NAME}

sort ${CHR_MIS_SORT} ${CHR_MIS_OUTFILE_NAME} > ${CHR_MIS_OUTFILE_NAME}.tmp
mv ${CHR_MIS_OUTFILE_NAME}.tmp ${CHR_MIS_OUTFILE_NAME}

${EGLOAD}/bin/formatreports.py

echo "Entrez Gene Load report formatting completed successfully." >> ${LOG_PROC}

exit 0

